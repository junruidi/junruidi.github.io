table(age)
table(age,surv$event)
age = ifelse(surv$Age>=70, "70+","70-")
efs = ifelse(surv$event == 1, "Deceased", "Survived")
table(age,surv$efs)
table(age,efs)
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
library(tableone)
load("data/analysis/survival_ready.rda")
var = c("Age","female","smoking_cat","alcohol_cat", "employ","bmi", "race","comorbid2", "TAC","LTAC","TLAC",
"lambda.a10","nb12","nb25","nb510","nb10p",
"tb12","tb25","tb510","tb10p","act_time")
cat = c("female","smoking_cat","alcohol_cat", "employ","race","comorbid2")
tab1 = CreateTableOne(vars = var,strata = "event",data = surv)
tab1.1 = print(tab1,format = "fp")
tab2 = CreateTableOne(vars = var,data = surv)
tab1.2 = print(tab2,format = "fp")
head(surv$sedtime_10+surv$act_time)
library(survival)
ApplyQuintiles <- function(x) {
as.character(cut(x, breaks=c(quantile(x,seq(0, 1, by = 0.25))),
labels=c("Q1","Q2","Q3","Q4"), include.lowest=TRUE))
}
surv$Q_la10 = ApplyQuintiles(surv$lambda.a10)
survfit_qla = survfit(Surv(time/365, event) ~ Q_la10, data = surv)
plot(survfit_qla, main = "Fragmentation v.s Survival",conf.int=FALSE, col=c("blue","red","green","purple"), xlab="Yrs", ylab = "Proportion Surviving")
legend("bottomleft", c("Q1","Q2","Q3","Q4"), col=c("blue","red","green","purple"), lty = 1)
surv$Q_tac = ApplyQuintiles(surv$TAC)
survfit_qtac = survfit(Surv(time/365, event) ~ Q_tac, data = surv)
plot(survfit_qtac, main = "TAC v.s Survival",conf.int=FALSE, col=c("blue","red","green","purple"), xlab="Yrs", ylab = "Proportion Surviving")
legend("bottomleft", c("Q1","Q2","Q3","Q4"), col=c("blue","red","green","purple"), lty = 1)
surv$Q_tlac = ApplyQuintiles(surv$TLAC)
survfit_qtlac = survfit(Surv(time/365, event) ~ Q_tlac, data = surv)
plot(survfit_qtlac, main = "TLAC v.s Survival",conf.int=FALSE, col=c("blue","red","green","purple"), xlab="Yrs", ylab = "Proportion Surviving")
legend("bottomleft", c("Q1","Q2","Q3","Q4"), col=c("blue","red","green","purple"), lty = 1)
surv$Q_ltac = ApplyQuintiles(surv$LTAC)
survfit_qltac = survfit(Surv(time/365, event) ~ Q_ltac, data = surv)
plot(survfit_qltac, main = "LTAC v.s Survival",conf.int=FALSE, col=c("blue","red","green","purple"), xlab="Yrs", ylab = "Proportion Surviving")
legend("bottomleft", c("Q1","Q2","Q3","Q4"), col=c("blue","red","green","purple"), lty = 1)
surv$Q_act = ApplyQuintiles(surv$act_time)
survfit_act = survfit(Surv(time/365, event) ~ Q_act, data = surv)
plot(survfit_act, main = "Active Time v.s Survival",conf.int=FALSE, col=c("blue","red","green","purple"), xlab="Yrs", ylab = "Proportion Surviving")
legend("bottomleft", c("Q1","Q2","Q3","Q4"), col=c("blue","red","green","purple"), lty = 1)
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
load("data/analysis/survival_ready.rda")
library(survival)
model.act10 = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
employ + bmi_cat + comorbid2  + scale(act_time) * Age,data = surv)
summary(model.act10)
# surv$Q_sed10 = ApplyQuintiles(surv$sedtime_10)
# model.qsed10 = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
#                      employ + bmi_cat + comorbid2  + Q_sed10 * Age,data = surv)
# summary(model.qsed10)
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
load("data/analysis/survival_ready.rda")
library(survival)
ApplyQuintiles <- function(x) {
as.character(cut(x, breaks=c(quantile(x,seq(0, 1, by = 0.25))),
labels=c("Q1","Q2","Q3","Q4"), include.lowest=TRUE))
}
surv$Q_la10 = ApplyQuintiles(surv$lambda.a10)
model.qla10 = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
employ + bmi_cat + comorbid2  + Q_la10 * Age,data = surv)
summary(model.qla10)
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
load("data/analysis/survival_ready.rda")
model.la10 = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
employ + bmi_cat + comorbid2  + scale(lambda.a10) * Age,data = surv)
summary(model.la10)
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
load("data/analysis/survival_ready.rda")
library(survival)
ApplyQuintiles <- function(x) {
as.character(cut(x, breaks=c(quantile(x,seq(0, 1, by = 0.25))),
labels=c("Q1","Q2","Q3","Q4"), include.lowest=TRUE))
}
surv$Q_la10 = ApplyQuintiles(surv$lambda.a10)
model.qla10 = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
employ + bmi_cat + comorbid2  + Q_la10 * Age,data = surv)
summary(model.qla10)
names(surv)
survdiff(Surv(time, event) ~ Q_la10, data=surv)
library(survival)
ApplyQuintiles <- function(x) {
as.character(cut(x, breaks=c(quantile(x,seq(0, 1, by = 0.25))),
labels=c("Q1","Q2","Q3","Q4"), include.lowest=TRUE))
}
surv$Q_la10 = ApplyQuintiles(surv$lambda.a10)
survfit_qla = survfit(Surv(time/365, event) ~ Q_la10, data = surv)
plot(survfit_qla, main = "Fragmentation v.s Survival",conf.int=FALSE, col=c("blue","red","green","purple"), xlab="Yrs", ylab = "Proportion Surviving")
legend("bottomleft", c("Q1","Q2","Q3","Q4"), col=c("blue","red","green","purple"), lty = 1)
survdiff(Surv(time, event) ~ Q_la10, data=surv)
surv$Q_tac = ApplyQuintiles(surv$TAC)
survfit_qtac = survfit(Surv(time/365, event) ~ Q_tac, data = surv)
plot(survfit_qtac, main = "TAC v.s Survival",conf.int=FALSE, col=c("blue","red","green","purple"), xlab="Yrs", ylab = "Proportion Surviving")
legend("bottomleft", c("Q1","Q2","Q3","Q4"), col=c("blue","red","green","purple"), lty = 1)
survdiff(Surv(time, event) ~ Q_tac, data=surv)
surv$Q_tlac = ApplyQuintiles(surv$TLAC)
survfit_qtlac = survfit(Surv(time/365, event) ~ Q_tlac, data = surv)
plot(survfit_qtlac, main = "TLAC v.s Survival",conf.int=FALSE, col=c("blue","red","green","purple"), xlab="Yrs", ylab = "Proportion Surviving")
legend("bottomleft", c("Q1","Q2","Q3","Q4"), col=c("blue","red","green","purple"), lty = 1)
survdiff(Surv(time, event) ~ Q_tlac, data=surv)
surv$Q_ltac = ApplyQuintiles(surv$LTAC)
survfit_qltac = survfit(Surv(time/365, event) ~ Q_ltac, data = surv)
plot(survfit_qltac, main = "LTAC v.s Survival",conf.int=FALSE, col=c("blue","red","green","purple"), xlab="Yrs", ylab = "Proportion Surviving")
legend("bottomleft", c("Q1","Q2","Q3","Q4"), col=c("blue","red","green","purple"), lty = 1)
survdiff(Surv(time, event) ~ Q_ltac, data=surv)
surv$Q_act = ApplyQuintiles(surv$act_time)
survfit_act = survfit(Surv(time/365, event) ~ Q_act, data = surv)
plot(survfit_act, main = "Active Time v.s Survival",conf.int=FALSE, col=c("blue","red","green","purple"), xlab="Yrs", ylab = "Proportion Surviving")
legend("bottomleft", c("Q1","Q2","Q3","Q4"), col=c("blue","red","green","purple"), lty = 1)
survdiff(Surv(time, event) ~ Q_act, data=surv)
names(surv)
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
load("data/analysis/survival_ready.rda")
model.tb12 = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
employ + bmi_cat + comorbid2  + I(tb12/act_time) * Age,data = surv)
summary(model.tb12)
x = surv$tb12/surv$act_time
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
load("data/analysis/survival_ready.rda")
x = surv$tb12/surv$act_time
model.tb12 = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
employ + bmi_cat + comorbid2  + x * Age,data = surv)
summary(model.tb12)
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
load("data/analysis/survival_ready.rda")
model.tb12 = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
employ + bmi_cat + comorbid2  + I(tb12/act_time) * Age,data = surv)
summary(model.tb12)
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
load("data/analysis/survival_ready.rda")
model.tb12 = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
employ + bmi_cat + comorbid2  + I(0.1* tb12/act_time) * Age,data = surv)
summary(model.tb12)
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
load("data/analysis/survival_ready.rda")
model.tb12 = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
employ + bmi_cat + comorbid2  + scale(I(tb12/act_time)) * Age,data = surv)
summary(model.tb12)
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
load("data/analysis/survival_ready.rda")
model.tb12 = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
employ + bmi_cat + comorbid2  + I(10 * tb12/act_time) * Age,data = surv)
summary(model.tb12)
y = rnorm(10)
x = rnorm(1-)
x = rnorm(10)
x = c(1:10)
summary(lm(y~x))
summary(lm(y~I(x*10))
)
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
load("data/analysis/survival_ready.rda")
model.tb25 = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
employ + bmi_cat + comorbid2  + I(10 * tb25/act_time) * Age,data = surv)
summary(model.tb25)
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
load("data/analysis/survival_ready.rda")
model.tb510 = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
employ + bmi_cat + comorbid2  + I(10 * tb510/act_time) * Age,data = surv)
summary(model.tb510)
rm(list = ls())
setwd("~/Dropbox/BLSA Mortality/")
load("data/analysis/survival_ready.rda")
model.tb10p = coxph(Surv(time, event) ~ female + factor(race) +  smoking_cat + alcohol_cat +
employ + bmi_cat + comorbid2  + I(10 * tb10p/act_time) * Age,data = surv)
summary(model.tb10p)
install.packages(c("callr", "ddalpha", "lubridate", "openssl", "quantreg", "RcppEigen", "smooth", "svMisc", "tseries", "viridis", "viridisLite"))
install.packages(c("bookdown", "devtools", "fda.usc", "nlme"))
install.packages(c("dbplyr", "forcats", "stringr", "XML"))
install.packages("devtools")
library(devtools)
?document
devtools::install_github("junruidi/actigraph")
devtools::install_github("junruidi/actigraphy")
1718.75 + 5578.11+1041.67
1083.33*3
1083.33*3+2125
1718.5 +8338.53+2125
8338.53+2125
install.packages(c("MASS", "pillar", "rpart", "svMisc", "timeDate", "usethis"))
install.packages("tidyselect")
rm(list = ls())
load("~/Dropbox/Junrui Di/Other papers/Adam CR/data/processed.rda")
rm(list = ls())
#1 minute epoch
load("~/Dropbox/Junrui Di/Other papers/Adam talf circadian/data/act_impute.rda")
head(activity$ID)
length(unique(activity$ID))
?tapply(vector, index, function)
?tapply
rm(list = ls())
#1 minute epoch
load("~/Dropbox/Junrui Di/Other papers/Adam talf circadian/data/act_impute.rda")
activity$Seq = NULL
rss = function(x){
return((x-mean(x))^2)
}
within_rss = activity %>% group_by("ID") %>% summarise_all(rss)
rm(list = ls())
#1 minute epoch
load("~/Dropbox/Junrui Di/Other papers/Adam talf circadian/data/act_impute.rda")
activity$Seq = NULL
rss = function(x){
return((x-mean(x))^2)
}
library(dplyr)
within_rss = activity %>% group_by("ID") %>% summarise_all(rss)
x = na.omit(activity)
head(activity$ID)
activity$ID[1:10]
a = activity$MIN1[1:17]
a = activity$MIN1[1:7]
activity$ID[1:7]
a = activity$MIN1[1:6]
rss(a)
rm(list = ls())
#1 minute epoch
load("~/Dropbox/Junrui Di/Other papers/Adam talf circadian/data/act_impute.rda")
activity$Seq = NULL
rss = function(x){
a = sum((x-mean(x))^2)
return(a)
}
library(dplyr)
rss = function(x){
a = sum((x-mean(x))^2)
return(a)
}
a = activity$MIN1[1:6]
a
rss(a)
var(a)
rm(list = ls())
#1 minute epoch
load("~/Dropbox/Junrui Di/Other papers/Adam talf circadian/data/act_impute.rda")
activity$Seq = NULL
rss = function(x){
a = sum((x-mean(x))^2)
return(a)
}
library(dplyr)
within_rss = activity %>% group_by("ID") %>% summarise_all(rss)
rm(list = ls())
#1 minute epoch
load("~/Dropbox/Junrui Di/Other papers/Adam CR/data/processed.rda")
rm(list = ls())
#1 minute epoch
load("~/Dropbox/Junrui Di/Other papers/Adam talf circadian/data/act_impute.rda")
activity$Seq = NULL
rss = function(x){
a = sum((x-mean(x))^2)
return(a)
}
library(dplyr)
within_rss = activity %>% group_by("ID") %>% summarise_all(rss)
head(names(activity))
id.list = unique(activity$ID)
rm(list = ls())
#1 minute epoch
load("~/Dropbox/Junrui Di/Other papers/Adam talf circadian/data/act_impute.rda")
activity$Seq = NULL
rss = function(x){
a = sum((x-mean(x))^2)
return(a)
}
id.list = unique(activity$ID)
i = 1
id.i = id.list[i]
dat = subset(activity, ID == id.i)
dat = as.matrix(subset(activity, ID == id.i)[,-1])
l = apply(dat, 2, rss)
id.list = unique(activity$ID)
result = data.frame()
for(i in 1:366){
id.i = id.list[i]
dat = as.matrix(subset(activity, ID == id.i)[,-1])
l = apply(dat, 2, rss)
result = rbind(result,l)
}
sum(is.na(result))
rm(list = ls())
#1 minute epoch
load("~/Dropbox/Junrui Di/Other papers/Adam talf circadian/data/act_impute.rda")
activity$Seq = NULL
rss = function(x){
a = sum((x-mean(x))^2)
return(a)
}
library(dplyr)
within_rss = activity %>% group_by(ID) %>% summarise_all(rss)
within_rss$MIN1[1]
?apply
within_var = apply(within_rss,2, sum)
within_var = apply(within_rss[,-1],2, sum)
within_var = apply(within_rss[,-1],2, sum)/(2110 - 366)
within_var = apply(within_rss[,-1],2, sum)
act_ave = as.data.frame(activity %>% group_by(ID) %>% summarise_all(funs(mean(.,na.rm = T))))
between_rss = apply(act_ave[,-1],2,rss)
between_var = between_rss/(366-1)
plot(x = c(1:1440), y = within_var)
plot(x = c(1:1440), y = between_var)
rm(list = ls())
#1 minute epoch
load("~/Dropbox/Junrui Di/Other papers/Adam talf circadian/data/act_impute.rda")
activity$Seq = NULL
rss = function(x){
a = sum((x-mean(x))^2)
return(a)
}
library(dplyr)
within_rss = activity %>% group_by(ID) %>% summarise_all(rss)
within_var = apply(within_rss[,-1],2, sum)/(2110 - 366)
act_ave = as.data.frame(activity %>% group_by(ID) %>% summarise_all(funs(mean(.,na.rm = T))))
between_rss = apply(act_ave[,-1],2,rss)
between_var = between_rss/(366-1)
plot(x = c(1:1440), y = within_var, type = "l", xlab = "Time",ylab = "", main = "Wintin Subject Variability")
plot(x = c(1:1440), y = betwee_var, type = "l", xlab = "Time",ylab = "", main = "Between Subject Variability")
plot(x = c(1:1440), y = between_var, type = "l", xlab = "Time",ylab = "", main = "Between Subject Variability")
contributors()
rm(list = ls())
#1 minute epoch
load("~/Dropbox/Junrui Di/Other papers/Adam talf circadian/data/act_impute.rda")
activity$Seq = NULL
rss = function(x){
a = sum((x-mean(x))^2)
return(a)
}
library(dplyr)
within_rss = activity %>% group_by(ID) %>% summarise_all(rss)
within_var = apply(within_rss[,-1],2, sum)/(2110 - 366)
act_ave = as.data.frame(activity %>% group_by(ID) %>% summarise_all(funs(mean(.,na.rm = T))))
between_rss = apply(act_ave[,-1],2,rss)
between_var = between_rss/(366-1)
plot(x = c(1:1440), y = within_var, type = "l", xlab = "Time",ylab = "", main = "Wintin Subject Variability")
plot(x = c(1:1440), y = between_var, type = "l", xlab = "Time",ylab = "", main = "Between Subject Variability")
plot(x = c(1:1440), y = icc, type = "l", xlab = "Time",ylab = "", main = "ICC")
View(within_rss)
icc = (between_var - within_var)/(between_var + within_var)
plot(x = c(1:1440), y = icc, type = "l", xlab = "Time",ylab = "", main = "ICC")
install.packages(c("DBI", "enc", "httpuv", "ICS", "JADE", "openssl", "RcppArmadillo", "rmarkdown", "tensorBSS"))
1/12
6/7
exp(0.13)
exp(-3/433987)
exp(-3.433987)
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
# git commit -m "2nd commit"
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
# git commit -m "2nd commit"
# git push origin master
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
# git commit -m "2nd commit"
# git push origin master
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
# git commit -m "2nd commit"
# git push origin master
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
# git commit -m "2nd commit"
# git push origin master
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
# git commit -m "2nd commit"
# git push origin master
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
# git commit -m "2nd commit"
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
# git commit -m "2nd commit"
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
# git commit -m "2nd commit"
# git push origin master
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
# git commit -m "2nd commit"
# git push origin master
#render your sweet site.
rmarkdown::render_site()
#render your sweet site.
rmarkdown::render_site()
#render your sweet site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
# git commit -m "2nd commit"
# git push origin master
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
# git commit -m "2nd commit"
# git push origin master
