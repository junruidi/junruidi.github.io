p0 = c(summary(cox.ph.ga_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.ga$coefficients[23:30],
CIL1 = confint(cox.ph.ga)[c(23:30),1],
CIU1 = confint(cox.ph.ga)[c(23:30),2],
p1 = summary(cox.ph.ga)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.ga$coefficients[23] + cox.ph.ga$coefficients[28:30]))
#gini
cox.ph.g = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
gini.r + gini.a + Q_aveps + Q4PS_gini.r + Q4PS_gini.a + avemvpa,design=svydata)
tableg = data.frame(beta1 = cox.ph.g$coefficients[23:30],
CIL1 = confint(cox.ph.g)[c(23:30),1],
CIU1 = confint(cox.ph.g)[c(23:30),2],
p1 = summary(cox.ph.g)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.g$coefficients[23] + cox.ph.g$coefficients[28],
cox.ph.g$coefficients[24] + cox.ph.g$coefficients[29],NA))
# 4. Average Hazard -------------------------------------------------------------------
#avehr
cox.ph.avehr_nointeraction = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
avehr + Q_aveps + avemvpa,design=svydata)
cox.ph.avehr = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
avehr * Q_aveps + avemvpa,design=svydata)
tablehr = data.frame(beta0 = c(cox.ph.avehr_nointeraction$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.avehr_nointeraction)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.avehr_nointeraction)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.avehr_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.avehr$coefficients[23:30],
CIL1 = confint(cox.ph.avehr)[c(23:30),1],
CIU1 = confint(cox.ph.avehr)[c(23:30),2],
p1 = summary(cox.ph.avehr)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.avehr$coefficients[23] + cox.ph.avehr$coefficients[28:30]))
#aveha
cox.ph.aveha_nointeraction = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
aveha + Q_aveps + avemvpa,design=svydata)
cox.ph.aveha = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
aveha * Q_aveps + avemvpa,design=svydata)
tableha = data.frame(beta0 = c(cox.ph.aveha_nointeraction$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.aveha_nointeraction)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.aveha_nointeraction)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.aveha_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.aveha$coefficients[23:30],
CIL1 = confint(cox.ph.aveha)[c(23:30),1],
CIU1 = confint(cox.ph.aveha)[c(23:30),2],
p1 = summary(cox.ph.aveha)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.aveha$coefficients[23] + cox.ph.aveha$coefficients[28:30]))
#aveh
cox.ph.h = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
avehr + aveha + Q_aveps + Q4PS_avehr + Q4PS_aveha + avemvpa,design=svydata)
tableh = data.frame(beta1 = cox.ph.h$coefficients[23:30],
CIL1 = confint(cox.ph.h)[c(23:30),1],
CIU1 = confint(cox.ph.h)[c(23:30),2],
p1 = summary(cox.ph.h)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.h$coefficients[23] + cox.ph.h$coefficients[28],
cox.ph.h$coefficients[24] + cox.ph.h$coefficients[29],NA))
# 5. alpha -------------------------------------------------------------------
#alpha_r
cox.ph.arest_nointeraction = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
arest + Q_aveps + avemvpa,design=svydata)
cox.ph.arest = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
arest * Q_aveps + avemvpa,design=svydata)
tablear = data.frame(beta0 = c(cox.ph.arest_nointeraction$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.arest_nointeraction)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.arest_nointeraction)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.arest_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.arest$coefficients[23:30],
CIL1 = confint(cox.ph.arest)[c(23:30),1],
CIU1 = confint(cox.ph.arest)[c(23:30),2],
p1 = summary(cox.ph.arest)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.arest$coefficients[23] + cox.ph.arest$coefficients[28:30]))
#alpha_a
cox.ph.aact_nointeraction = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
aact + Q_aveps + avemvpa,design=svydata)
cox.ph.aact = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
aact * Q_aveps + avemvpa,design=svydata)
tableaa = data.frame(beta0 = c(cox.ph.aact_nointeraction$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.aact_nointeraction)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.aact_nointeraction)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.aact_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.aact$coefficients[23:30],
CIL1 = confint(cox.ph.aact)[c(23:30),1],
CIU1 = confint(cox.ph.aact)[c(23:30),2],
p1 = summary(cox.ph.aact)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.aact$coefficients[23] + cox.ph.aact$coefficients[28:30]))
#alpha
cox.ph.a = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
arest + aact + Q_aveps + Q4PS_arest + Q4PS_aact + avemvpa,design=svydata)
tablea = data.frame(beta1 = cox.ph.a$coefficients[23:30],
CIL1 = confint(cox.ph.a)[c(23:30),1],
CIU1 = confint(cox.ph.a)[c(23:30),2],
p1 = summary(cox.ph.a)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.a$coefficients[23] + cox.ph.a$coefficients[28],
cox.ph.a$coefficients[24] + cox.ph.a$coefficients[29],NA))
########
Stable = rbind(tablemur,tablelr,tablegr,tablehr,tablear)
Stable$sig0 = ifelse(Stable$p0 < 0.05, "*","")
Stable$ci0 = paste0("(",round(Stable$CIL0,2),", ",round(Stable$CIU0,2),")")
Stable$sig1 = ifelse(Stable$p1 < 0.05, "*","")
Stable$ci1 = paste0("(",round(Stable$CIL1,2),", ",round(Stable$CIU1,2),")")
Atable = rbind(tablemua,tablela,tablega,tableha,tableaa)
Atable$sig0 = ifelse(Atable$p0 < 0.05, "*","")
Atable$ci0 = paste0("(",round(Atable$CIL0,2),", ",round(Atable$CIU0,2),")")
Atable$sig1 = ifelse(Atable$p1 < 0.05, "*","")
Atable$ci1 = paste0("(",round(Atable$CIL1,2),", ",round(Atable$CIU1,2),")")
jtable = rbind(tablemu,tablel,tableg,tableh,tablea)
jtable$sig1 = ifelse(jtable$p1 < 0.05, "*","")
jtable$ci1 = paste0("(",round(jtable$CIL1,2),", ",round(jtable$CIU1,2),")")
write.csv(Stable,"~/Dropbox/Junrui Di/fragmentation/Review AJE/aggregate3/result/reverse causality/s_rev.csv")
write.csv(Atable,"~/Dropbox/Junrui Di/fragmentation/Review AJE/aggregate3/result/reverse causality/a_rev.csv")
write.csv(jtable,"~/Dropbox/Junrui Di/fragmentation/Review AJE/aggregate3/result/reverse causality/joint_rev.csv")
rm(list = ls())
library(survey)
library(survival)
load("~/Dropbox/Junrui Di/fragmentation/Review AJE/aggregate3/data/survival_1020.rda")
# 1. MU -------------------------------------------------------------------
#mu.r
cox.ph.mur_nointeraction = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
mu.r + Q_aveps + avemvpa,design=svydata)
summary(cox.ph.mur_nointeraction)
cox.ph.mur = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
mu.r * Q_aveps + avemvpa,design=svydata)
summary(cox.ph.mur)
tablemur = data.frame(beta0 = c(cox.ph.mur_nointeraction$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.mur_nointeraction)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.mur_nointeraction)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.mur_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.mur$coefficients[23:30],
CIL1 = confint(cox.ph.mur)[c(23:30),1],
CIU1 = confint(cox.ph.mur)[c(23:30),2],
p1 = summary(cox.ph.mur)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.mur$coefficients[23] + cox.ph.mur$coefficients[28:30]))
#mu.a
cox.ph.mua_nointeraction = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
mu.a + Q_aveps + avemvpa,design=svydata)
summary(cox.ph.mua_nointeraction)
cox.ph.mua = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
mu.a * Q_aveps + avemvpa,design=svydata)
summary(cox.ph.mua)
tablemua = data.frame(beta0 = c(cox.ph.mua_nointeraction$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.mua_nointeraction)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.mua_nointeraction)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.mua_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.mua$coefficients[23:30],
CIL1 = confint(cox.ph.mua)[c(23:30),1],
CIU1 = confint(cox.ph.mua)[c(23:30),2],
p1 = summary(cox.ph.mua)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.mua$coefficients[23] + cox.ph.mua$coefficients[28:30]))
#mu
cox.ph.mu = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
mu.r + mu.a + Q_aveps + Q4PS_mu.r + Q4PS_mu.a + avemvpa,design=svydata)
summary(cox.ph.mu)
tablemu = data.frame(beta1 = cox.ph.mu$coefficients[23:30],
CIL1 = confint(cox.ph.mu)[c(23:30),1],
CIU1 = confint(cox.ph.mu)[c(23:30),2],
p1 = summary(cox.ph.mu)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.mu$coefficients[23] + cox.ph.mu$coefficients[28],
cox.ph.mu$coefficients[24] + cox.ph.mu$coefficients[29],NA))
# 2. LAMBDA -------------------------------------------------------------------
#lambda.r
cox.ph.lr_nointeractions = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
lambda.r + Q_aveps + avemvpa,design=svydata)
summary(cox.ph.lr_nointeractions)
cox.ph.lr = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
lambda.r * Q_aveps + avemvpa,design=svydata)
summary(cox.ph.lr)
tablelr = data.frame(beta0 = c(cox.ph.lr_nointeractions$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.lr_nointeractions)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.lr_nointeractions)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.lr_nointeractions)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.lr$coefficients[23:30],
CIL1 = confint(cox.ph.lr)[c(23:30),1],
CIU1 = confint(cox.ph.lr)[c(23:30),2],
p1 = summary(cox.ph.lr)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.lr$coefficients[23] + cox.ph.lr$coefficients[28:30]))
#lambda.a
cox.ph.la_nointeraction = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
lambda.a + Q_aveps + avemvpa,design=svydata)
summary(cox.ph.la_nointeraction)
cox.ph.la = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
lambda.a * Q_aveps + avemvpa,design=svydata)
summary(cox.ph.la)
tablela = data.frame(beta0 = c(cox.ph.la_nointeraction$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.la_nointeraction)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.la_nointeraction)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.la_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.la$coefficients[23:30],
CIL1 = confint(cox.ph.la)[c(23:30),1],
CIU1 = confint(cox.ph.la)[c(23:30),2],
p1 = summary(cox.ph.la)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.la$coefficients[23] + cox.ph.la$coefficients[28:30]))
#lambda
cox.ph.l = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
lambda.r + lambda.a + Q_aveps + Q4PS_lambda.r + Q4PS_lambda.a + avemvpa,design=svydata)
summary(cox.ph.l)
tablel = data.frame(beta1 = cox.ph.l$coefficients[23:30],
CIL1 = confint(cox.ph.l)[c(23:30),1],
CIU1 = confint(cox.ph.l)[c(23:30),2],
p1 = summary(cox.ph.l)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.l$coefficients[23] + cox.ph.l$coefficients[28],
cox.ph.l$coefficients[24] + cox.ph.l$coefficients[29],NA))
# 3. Gini -------------------------------------------------------------------
#gini.r
cox.ph.gr_nointeraction = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
gini.r + Q_aveps + avemvpa,design=svydata)
summary(cox.ph.gr_nointeraction)
cox.ph.gr = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
gini.r * Q_aveps + avemvpa,design=svydata)
summary(cox.ph.gr)
tablegr = data.frame(beta0 = c(cox.ph.gr_nointeraction$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.gr_nointeraction)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.gr_nointeraction)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.gr_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.gr$coefficients[23:30],
CIL1 = confint(cox.ph.gr)[c(23:30),1],
CIU1 = confint(cox.ph.gr)[c(23:30),2],
p1 = summary(cox.ph.gr)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.gr$coefficients[23] + cox.ph.gr$coefficients[28:30]))
#gini.a
cox.ph.ga_nointeraction = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
gini.a + Q_aveps + avemvpa,design=svydata)
summary(cox.ph.ga_nointeraction)
cox.ph.ga = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
gini.a * Q_aveps + avemvpa,design=svydata)
summary(cox.ph.ga)
tablega = data.frame(beta0 = c(cox.ph.ga_nointeraction$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.ga_nointeraction)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.ga_nointeraction)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.ga_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.ga$coefficients[23:30],
CIL1 = confint(cox.ph.ga)[c(23:30),1],
CIU1 = confint(cox.ph.ga)[c(23:30),2],
p1 = summary(cox.ph.ga)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.ga$coefficients[23] + cox.ph.ga$coefficients[28:30]))
#gini
cox.ph.g = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
gini.r + gini.a + Q_aveps + Q4PS_gini.r + Q4PS_gini.a + avemvpa,design=svydata)
summary(cox.ph.g)
tableg = data.frame(beta1 = cox.ph.g$coefficients[23:30],
CIL1 = confint(cox.ph.g)[c(23:30),1],
CIU1 = confint(cox.ph.g)[c(23:30),2],
p1 = summary(cox.ph.g)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.g$coefficients[23] + cox.ph.g$coefficients[28],
cox.ph.g$coefficients[24] + cox.ph.g$coefficients[29],NA))
# 4. Average Hazard -------------------------------------------------------------------
#avehr
cox.ph.avehr_nointeraction = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
avehr + Q_aveps + avemvpa,design=svydata)
summary(cox.ph.avehr_nointeraction)
cox.ph.avehr = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
avehr * Q_aveps + avemvpa,design=svydata)
summary(cox.ph.avehr)
tablehr = data.frame(beta0 = c(cox.ph.avehr_nointeraction$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.avehr_nointeraction)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.avehr_nointeraction)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.avehr_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.avehr$coefficients[23:30],
CIL1 = confint(cox.ph.avehr)[c(23:30),1],
CIU1 = confint(cox.ph.avehr)[c(23:30),2],
p1 = summary(cox.ph.avehr)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.avehr$coefficients[23] + cox.ph.avehr$coefficients[28:30]))
#aveha
cox.ph.aveha_nointeraction = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
aveha + Q_aveps + avemvpa,design=svydata)
summary(cox.ph.aveha_nointeraction)
cox.ph.aveha = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
aveha * Q_aveps + avemvpa,design=svydata)
summary(cox.ph.aveha)
tableha = data.frame(beta0 = c(cox.ph.aveha_nointeraction$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.aveha_nointeraction)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.aveha_nointeraction)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.aveha_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.aveha$coefficients[23:30],
CIL1 = confint(cox.ph.aveha)[c(23:30),1],
CIU1 = confint(cox.ph.aveha)[c(23:30),2],
p1 = summary(cox.ph.aveha)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.aveha$coefficients[23] + cox.ph.aveha$coefficients[28:30]))
#aveh
cox.ph.h = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
avehr + aveha + Q_aveps + Q4PS_avehr + Q4PS_aveha + avemvpa,design=svydata)
summary(cox.ph.h)
tableh = data.frame(beta1 = cox.ph.h$coefficients[23:30],
CIL1 = confint(cox.ph.h)[c(23:30),1],
CIU1 = confint(cox.ph.h)[c(23:30),2],
p1 = summary(cox.ph.h)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.h$coefficients[23] + cox.ph.h$coefficients[28],
cox.ph.h$coefficients[24] + cox.ph.h$coefficients[29],NA))
# 5. alpha -------------------------------------------------------------------
#alpha_r
cox.ph.arest_nointeraction = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
arest + Q_aveps + avemvpa,design=svydata)
summary(cox.ph.arest_nointeraction)
cox.ph.arest = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
arest * Q_aveps + avemvpa,design=svydata)
summary(cox.ph.arest)
tablear = data.frame(beta0 = c(cox.ph.arest_nointeraction$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.arest_nointeraction)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.arest_nointeraction)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.arest_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.arest$coefficients[23:30],
CIL1 = confint(cox.ph.arest)[c(23:30),1],
CIU1 = confint(cox.ph.arest)[c(23:30),2],
p1 = summary(cox.ph.arest)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.arest$coefficients[23] + cox.ph.arest$coefficients[28:30]))
#alpha_a
cox.ph.aact_nointeraction = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
aact + Q_aveps + avemvpa,design=svydata)
summary(cox.ph.aact_nointeraction)
cox.ph.aact = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
aact * Q_aveps + avemvpa,design=svydata)
summary(cox.ph.aact)
tableaa = data.frame(beta0 = c(cox.ph.aact_nointeraction$coefficients[23:27],NA,NA,NA),
CIL0 = c(confint(cox.ph.aact_nointeraction)[c(23:27),1],NA,NA,NA),
CIU0 = c(confint(cox.ph.aact_nointeraction)[c(23:27),2],NA,NA,NA),
p0 = c(summary(cox.ph.aact_nointeraction)$coefficients[c(23:27),5],NA,NA,NA),
beta1 = cox.ph.aact$coefficients[23:30],
CIL1 = confint(cox.ph.aact)[c(23:30),1],
CIU1 = confint(cox.ph.aact)[c(23:30),2],
p1 = summary(cox.ph.aact)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.aact$coefficients[23] + cox.ph.aact$coefficients[28:30]))
#alpha
cox.ph.a = svycoxph(Surv(permth_exm/12,mortstat) ~ age + Male  + BMXBMI+
diabetes + CHF + stroke + cancer + CHD+
MobilityProblem + Mexican + HispanicOther + Black + OtherRace +
LessThanHS + HighSchool + MissingEduc +CurrentSmoker + FormerSmoker +
FormerDrinker + ModerateDrinker+ HeavyDrinker+ MissingAlcohol+
arest + aact + Q_aveps + Q4PS_arest + Q4PS_aact + avemvpa,design=svydata)
summary(cox.ph.a)
tablea = data.frame(beta1 = cox.ph.a$coefficients[23:30],
CIL1 = confint(cox.ph.a)[c(23:30),1],
CIU1 = confint(cox.ph.a)[c(23:30),2],
p1 = summary(cox.ph.a)$coefficients[c(23:30),5],
adjustbeta1 = c(rep(NA,5),cox.ph.a$coefficients[23] + cox.ph.a$coefficients[28],
cox.ph.a$coefficients[24] + cox.ph.a$coefficients[29],NA))
########
Stable = rbind(tablemur,tablelr,tablegr,tablehr,tablear)
Stable$sig0 = ifelse(Stable$p0 < 0.05, "*","")
Stable$ci0 = paste0("(",round(Stable$CIL0,2),", ",round(Stable$CIU0,2),")")
Stable$sig1 = ifelse(Stable$p1 < 0.05, "*","")
Stable$ci1 = paste0("(",round(Stable$CIL1,2),", ",round(Stable$CIU1,2),")")
Atable = rbind(tablemua,tablela,tablega,tableha,tableaa)
Atable$sig0 = ifelse(Atable$p0 < 0.05, "*","")
Atable$ci0 = paste0("(",round(Atable$CIL0,2),", ",round(Atable$CIU0,2),")")
Atable$sig1 = ifelse(Atable$p1 < 0.05, "*","")
Atable$ci1 = paste0("(",round(Atable$CIL1,2),", ",round(Atable$CIU1,2),")")
jtable = rbind(tablemu,tablel,tableg,tableh,tablea)
jtable$sig1 = ifelse(jtable$p1 < 0.05, "*","")
jtable$ci1 = paste0("(",round(jtable$CIL1,2),", ",round(jtable$CIU1,2),")")
write.csv(Stable,"~/Dropbox/Junrui Di/fragmentation/Review AJE/aggregate3/result/10to20/s_1020.csv")
write.csv(Atable,"~/Dropbox/Junrui Di/fragmentation/Review AJE/aggregate3/result/10to20/a_1020.csv")
write.csv(jtable,"~/Dropbox/Junrui Di/fragmentation/Review AJE/aggregate3/result/10to20//joint_1020.csv")
rm(list = ls())
library(survey)
library(survival)
load("~/Dropbox/Junrui Di/fragmentation/Review AJE/aggregate3/data/survival_all.rda")
x = svydata$variables
d = cbind(x$Q4PS_arest,x$Q4_Ps,x$arest
)
View(d)
qnorm(0.25)
library(actcol)
devtools::install_github("junruidi/actcool")
library(actcool)
accelsummary()
accelsummary
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("~/Dropbox/web/junruidi.github.io/")
#render your sweet site.
rmarkdown::render_site()
# git add -A
# git commit -m "2nd commit"
# git push origin master
